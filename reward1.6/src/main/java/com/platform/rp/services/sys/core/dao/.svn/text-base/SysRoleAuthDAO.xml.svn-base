<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.platform.rp.services.sys.core.dao.SysRoleAuthDAO">
	
    <resultMap type="com.platform.rp.services.sys.core.dao.entity.SysRoleAuthEntity" id="sysRoleAuthEntityMap">
		<id column="sys_role_auth_id" property="sysRoleAuthId" />
		<result column="role_id" property="roleId" />
		<result column="auth_id" property="authId" />
		<result column="create_time" property="createTime" />
    </resultMap>
    
     <resultMap type="com.platform.rp.services.sys.inner.vo.SysRoleAuthVo" id="sysRoleAuthVoMap">
		<result column="sys_role_auth_id" property="sysRoleAuthId" />
		<result column="role_id" property="roleId" />
		<result column="auth_id" property="authId" />
		<result column="create_time" property="createTime" />
		<result column="auth_code" property="authCode" />
		<result column="auth_name" property="authName" />
		<result column="parent_id" property="parentId" />
		<result column="auth_type" property="authType" />
		<result column="auth_url" property="authUrl" />
    </resultMap>

	<select id="getRoleAuthList" resultMap="sysRoleAuthVoMap" parameterType="int">
		select * from   sys_role_auth_detail sys, sys_role_info role, sys_auth_info auth
		where  sys.role_id = role.sys_role_id and sys.auth_id = auth.sys_auth_id
		and role.sys_role_id=#{sysRoleId}
		order by auth.sort, auth.sys_auth_id
	</select>

	<select id="getRoleAuthEntityList" resultMap="sysRoleAuthEntityMap" parameterType="int">
		select * from sys_role_auth_detail sys where sys.role_id=#{sysRoleId}
	</select>
	
	<delete id="deleteByRoleId" parameterType="int">
		delete from sys_role_auth_detail where role_id = #{roleId}
	</delete>
	
	<insert id="save" useGeneratedKeys="true" keyProperty="sysRoleAuthId"  parameterType="com.platform.rp.services.sys.core.dao.entity.SysRoleAuthEntity">
	    insert into sys_role_auth_detail(role_id, auth_id, create_time)
	    values(#{roleId},#{authId},#{createTime})
	</insert>
</mapper>