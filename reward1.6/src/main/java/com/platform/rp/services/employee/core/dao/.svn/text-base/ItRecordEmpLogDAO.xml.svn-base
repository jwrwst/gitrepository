<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.platform.rp.services.employee.core.dao.ItRecordEmpLogDAO">
    
    <resultMap type="com.platform.rp.services.employee.core.dao.entity.ItRecordEmpLogEntity" id="itRecordEmpLogEntityMap">
        <id column="id" property="id" />
        <result column="emp_id" property="empId" />
        <result column="store_id" property="storeId" />
		<result column="nickname" property="nickname" />
		<result column="record_type" property="recordType" />
		<result column="receivable" property="receivable" />
		<result column="paid" property="paid" />
		<result column="fid" property="fid" />
		<result column="remark" property="remark" />
		<result column="create_time" property="createTime" />
		<result column="busdate" property="busdate" />
	</resultMap>
	
    <resultMap type="com.platform.rp.services.employee.external.vo.RecordEmpLogVo" id="recordEmpLogVoMap">
		<result column="id" property="id" />
		<result column="emp_id" property="empId" />
        <result column="store_id" property="storeId" />
		<result column="nickname" property="nickname" />
		<result column="record_type" property="recordType" />
		<result column="receivable" property="receivable" />
		<result column="paid" property="paid" />
		<result column="fid" property="fid" />
		<result column="remark" property="remark" />
		<result column="create_time" property="createTime" />
		<result column="busdate" property="busdate" />
	</resultMap>
	
    <insert id="save" useGeneratedKeys="true" keyProperty="id" parameterType="com.platform.rp.services.employee.core.dao.entity.ItRecordEmpLogEntity">
		insert into it_record_emp_log(emp_id,store_id,nickname,record_type,receivable,paid,create_time,fid,remark,busdate)
		values(#{empId},#{storeId},#{nickname},#{recordType},#{receivable},#{paid},#{createTime},#{fid},#{remark},#{busdate})
	</insert>
	
    <select id="getRecordLogListByStoreId" resultType="com.platform.rp.services.employee.core.dao.entity.ItRecordEmpLogEntity" parameterType="int">
		Select * from it_record_emp_log
		where store_id = #{storeId}
		order by create_time desc
	</select>
	
    <sql id="page">
		<if test="start > -1">
			<if test="pageSize > 0">
				limit #{start}, #{pageSize}
			</if>
			<if test="pageSize == 0 or pageSize == '' or pageSize &lt; 0">
				limit #{start}
			</if>
		</if>
	</sql>

	<select id="getPage" resultMap="recordEmpLogVoMap" parameterType="map">
		Select * from it_record_emp_log
		<where>
		    1 = 1
		    <if test = "storeId != 0 and storeId != null"> and store_id = #{storeId} </if>
		    <if test = "empId != 0 and empId != null"> and emp_id = #{empId} </if>
		    <if test = "recordType != null and recordType >= 0"> and record_type = #{recordType} </if>
		    <if test = "recordType == -1"> and (record_type = 0 or record_type = 1) </if>
		    <if test = "recordType == -2"> and (record_type = 0 or record_type = 2) </if>
		</where>
		order by create_time desc 
		<include refid="page" />
	</select>

	<select id="count" resultType="int" parameterType="map">
		select count(1) from it_record_emp_log
		<where>
		    1 = 1
		    <if test = "storeId != 0 and storeId != null"> and store_id = #{storeId} </if>
		    <if test = "empId != 0 and empId != null"> and emp_id = #{empId} </if>
		    <if test = "recordType != null and recordType >= 0"> and record_type = #{recordType} </if>
		    <if test = "recordType == -1"> and (record_type = 0 or record_type = 1) </if>
		    <if test = "recordType == -2"> and (record_type = 0 or record_type = 2) </if>
		</where>
	</select>
	
</mapper>