<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
<title>修改密码</title>
<link href="${basepath}/assets/plugin/mui/dist/css/mui.min.css"
	rel="stylesheet" />
<link href="${basepath}/assets/def/css/tips.css" rel="stylesheet" />
<style>
html,body {
	margin: 0;
	overflow-x: hidden;
}

.mui-bar a.mui-icon,.mui-bar .mui-icon:active {
	color: #EA4F16;
	opacity: 1;
}

.mui-input-row .mui-input-password ~.mui-icon-eye {
	background: url("${basepath}/assets/def/images/bind-audit11.png") center
		8px no-repeat;
	background-size: 25px;
}

.mui-input-row .mui-input-password ~.mui-icon-eye.mui-active {
	background: url("${basepath}/assets/def/images/bind-audit12.png") center
		8px no-repeat;
	background-size: 25px;
}

.mui-icon-eye:before {
	content: none;
}
</style>
</head>
<body>
	<header class="mui-bar mui-bar-nav">
		<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
		<h1 class="mui-title">密码修改</h1>
	</header>
	<!--页面主结构开始-->
	<div class="mui-content  plat-content">
		<form class="mui-input-group" style="margin-top: 10px;" id="updatePasswordForm">
			<input type="hidden" name="account"  id="account"   placeholder="请输入原密码">
			<div class="mui-input-row">
				<label>原密码</label> <input type="text" name="srcPassword" placeholder="请输入原密码">
			</div>
			<div class="mui-input-row">
				<label>新密码</label> <input type="password" name="password" placeholder="请输入新密码"
					class="mui-input-password" style="padding-right: 38px;">
			</div>
		</form>
		<p class="mui-table-view-cell">
			<a style="color: #EA4F16; float:right;" href="#" id="findPassword">找回密码</a> 密码长度6-20个字符
		</p>
			<div class="tips-reginfo-submit"
		style="position: absolute; left: 10px; bottom: 20px; right: 10px;">
		<button type="button" class="mui-btn mui-btn-warning mui-btn-block" id="submit">确定</button>
	</div>
	</div>





</body>
<script src="${basepath}/assets/plugin/require.js"></script>
<script type="text/javascript"
	src="${basepath}/assets/def/js/tips/tips.js"></script>
	
<script type="text/javascript">

require([ "jquery", "mui", "mui_view", "addr", "common", "ftscroller" ],
		function($$, mui, mui_view, addr, tools) {

			var mobile  = localStorage.getItem("mobile");
			$("#account").val(mobile);
			
			function checkNotNul(value,tip){
				if (value == "") {
					tools.toastTip("错误", tip);
					return false;
				}else{
					return true;
				}
			}
			//修改密码
			mui(".tips-reginfo-submit").on('tap', '#submit', function() {
				//alert(1)
	    		var obj= $("#updatePasswordForm").serializeJson();;
				if(!checkNotNul(obj.srcPassword,"原密码不能为空")){
					return false;
				}
				if(!checkNotNul(obj.password,"新密码不能为空")){
					return false;
				}
				addr.updatePassword(
					JSON.stringify(obj),
					function(datas) {
						var status = datas.resultMessage.status;
						if(status==0){
							tools.toast("成功","修改成功!",function(){
								history.back(-1);
							});
							//tools.confirm("修改成功","是否返回",function(back){
							//	if(back.index==1){
									
							//	}
							//});
						}else{
							tools.toastTip("错误", ""+datas.resultMessage.messageText+"");
						}
					
					});		
			});	

			//找回密码
			mui("body").on('tap', '#findPassword', function() {
				//var mobile=$("#bindMobile").children("span").html();
				//window.localStorage.setItem("mobile",mobile.trim());
				//商户账号
				//localStorage.setItem("_user_account",Account.account);
				window.location.href = "tips_merchants_refindpsd.xhtml";	
			});
		});
</script>	
</html>

















