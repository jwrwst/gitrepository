<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.platform.rp.services.sys.core.dao.SysUserRoleDetailDAO">

	<select id="getUserRoleDetailVo"
		resultType="com.platform.rp.services.sys.inner.vo.SysUserRoleDetailVo"
		parameterType="int">
		select sys.sys_role_auth_id userRoleId,
		sys.user_id userId,
		sys.role_id roleId,
		sys.create_time createTime,
		role.role_name roleName
		from sys_user_role_detail sys, sys_user_info user, sys_role_info role
		where sys.user_id = user.sys_user_id
    	and sys.role_id = role.sys_role_id
		and user.sys_user_id = #{sysUserId}
	</select>

	<select id="getUserRoleDetailEntityList" resultType="com.platform.rp.services.sys.inner.vo.SysUserRoleDetailVo"
		parameterType="int">
		select * from sys_user_role_detail 
	</select>
	
	<delete id="deleteByRoleId" parameterType="int">
	    delete from sys_user_role_detail where role_id = #{roleId}
	</delete>
	
	<delete id="delete" parameterType="int">
	    delete from sys_user_role_detail where sys_role_auth_id = #{id}
	</delete>
	
	<insert id="save" parameterType="com.platform.rp.services.sys.inner.vo.SysUserRoleDetailVo" useGeneratedKeys="true" keyProperty="userRoleId">
	    insert into sys_user_role_detail(user_id,role_id,create_time)
	    values(#{userId}, #{roleId}, #{createTime})
	</insert>
	
	<update id="update" parameterType="com.platform.rp.services.sys.inner.vo.SysUserRoleDetailVo">
	    update sys_user_role_detail
	    <set>
	        <if test="userId != null">
	            user_id = #{userId},
	        </if>
	        <if test="roleId != null">
	            role_id = #{roleId},
	        </if>
	    </set>
	    where sys_role_auth_id = #{userRoleId}
	</update>
</mapper>